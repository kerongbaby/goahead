<!DOCTYPE html>
<html lang="en">
<head>
<title>Home Page</title>
<script type="text/javascript">
    var count = 0;
    function wsOnline() {
        const ws = new WebSocket("ws://" + window.location.host + "/websocket");
        var timer;
        ws.onopen = e => {
            console.log(`WebSocket onopen state: ${ws.readyState}`)
            timer = setInterval(function() {
                console.log("Send message");
                ws.send("HELLO: " + count);
                count++;
            }, 1000);
        }

        ws.onerror = e => {
            clearInterval(timer);
            if(null == e)
                console.log("WebSocket error with " + e);
            else
                console.log("WebSocket error without message");
        }

        ws.onmessage = data => {
            console.log("WebSocket have message")
        }

        ws.onclose = data => {
            console.log("WebSocket onclose closed")
            clearInterval(timer);
            console.log(data);
        }
    }

    window.onload=function(){
        wsOnline();
    }
</script>
</head>

<body>
    <p>Congratulations! The server is up and running.<p/>
</body>
</html>
